// naja framefork initialization
naja.initialize();

$(document).ready(function () {

    // clicking on an entire cell
    $('.clickWhole').on('click', function() {
        window.location = $(this).find('a').attr('href');
    });


    // Opening a modal dialog
    var openModal = function (e) {
        $('#modalEdit').modal('open');
    }
    var openModalConfirm = function (e) {
        $('#modalConfirm').modal('open');
    }

    $('.modal').modal();
    $('.modalConfirm').modal();
    $('.item-add').on('click', openModal);
    $('.item-edit').on('click', openModal);
    $('.item-delete').on('click', openModalConfirm);

    // closing the dialog after saving and printing the report
    var afterUpdate = function (event) {
        $('.item-edit').on('click', openModal);
        $('.item-delete').on('click', openModalConfirm);
        if (event.detail.snippet.id == 'snippet--snippetFlash' || event.detail.snippet.id == 'snippet-simpleCrudList-snippetFlash' || event.detail.snippet.id == 'snippet-simpleCrudItem-snippetFlash') {
            M.toast({html: event.detail.content});
        }
        if (event.detail.snippet.id === 'snippet--paginator') {
            naja.initialize()
        }
    }

    naja.snippetHandler.addEventListener('afterUpdate', (event) => afterUpdate(event));
    naja.addEventListener('success', (event) => {
        console.log(event);
        if (event.detail.payload.saved) {
            $('.modal').modal('close');
        }
    });

    // Slider configuration
    var slider = document.getElementById('row-slider');
    noUiSlider.create(slider, {
        start: sliderItemsPerPageCount,
        snap: true,
        connect: true,
        tooltips: true,
        range: {
            'min': 3,
            '10%': 5,
            '20%': 7,
            '30%': 10,
            '40%': 20,
            '50%': 30,
            '75%': 75,
            'max': 100
        },
        pips: {
            mode: 'steps',
            density: 3,
        },
    });

    // Signal processing after position change
    // proměné sliderItemsPerPageSignal
    if (sliderItemsPerPageSignal) {
        slider.noUiSlider.on('set', function () {
            let componet = sliderComponentName + '-itemsPerPage';
            let RequestData = {};
            RequestData[componet] = slider.noUiSlider.get();
            naja.makeRequest('GET', sliderItemsPerPageSignal, RequestData);
        })
    }
})
